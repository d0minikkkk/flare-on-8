after the GUI closes, there is a huge `mov` operation to load shellcode into memory.there will be calls to `VirtualAllocExNumA` and `memmove`. There will then be calls to `VirtualAlloc` and `VirtualProtect`. Dump using x64dbg and scylla to get the first DLL. Try to use Dump PE feature of Scylla to make sure PE does not break. The original exe will then call a function within the DLL. Follow that function and eventually there will be yet another `VirtualAlloc` to load another DLL into memory. For the second DLL, find the source of the data, and dump out using dump memory feature of x64dbg/Scylla. For this case, it is copied into the buffer using `rep movsb`. There are anti debug checks within the second DLL. It checks the Process Name and expects it to be `Spell.EXE`. There is also a call to a long `SleepEx` WinAPI. Patch that. There is also another function to contact a non-existent domain. Patch out that function and set EAX to 1. The next function called should be a decryption function using `BCrypt`. It fetches offset 25 of the PNG resource in original exe to decrypt using hash of ' ' as key. Rename `rundll32` to `Spell.EXE` and copy over the resources to bypass the checks during debugging. After the call to `BCryptDecrypt`, l3rlcps_7r_vb33eehskc3 is the result. After decryption, there will be a flag scrambler function, set `xmm0` and `xmm1` to 0 to get the correct sequence of flag.

`b3s7_sp3llcheck3r_ev3r@flare-on.com`
